

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Layer Overview and Examples &mdash; pydeck 0.3.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Deck" href="deck.html" />
    <link rel="prev" title="Installing pydeck" href="installation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> pydeck
          

          
          </a>

          
            
            
              <div class="version">
                0.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installing pydeck</a></li>
</ul>
<p class="caption"><span class="caption-text">Usage</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Layer Overview and Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#understanding-keyword-arguments-in-pydeck-layers">Understanding keyword arguments in pydeck layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-type-positional-argument">The <code class="docutils literal notranslate"><span class="pre">type</span></code> positional argument</a></li>
<li class="toctree-l2"><a class="reference internal" href="#expression-parsers-in-pydeck-objects">Expression parsers in pydeck objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="#passing-string-constants">Passing string constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="#understanding-get-position">Understanding <code class="docutils literal notranslate"><span class="pre">get_position</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#example-vancouver-property-values">Example: Vancouver property values</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="deck.html">Deck</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_utils.html">Data utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="view_state.html">ViewState</a></li>
<li class="toctree-l1"><a class="reference internal" href="view.html">View</a></li>
<li class="toctree-l1"><a class="reference internal" href="light_settings.html">LightSettings</a></li>
</ul>
<p class="caption"><span class="caption-text">Jupyter</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="jupyter.html">Jupyter-specific features</a></li>
<li class="toctree-l1"><a class="reference internal" href="binary_transfer.html">Binary data transfer</a></li>
</ul>
<p class="caption"><span class="caption-text">Further customization</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tooltip.html">Configuring tooltips</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_layers.html">Custom layers</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pydeck</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Layer Overview and Examples</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/layer.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="layer-overview-and-examples">
<h1>Layer Overview and Examples<a class="headerlink" href="#layer-overview-and-examples" title="Permalink to this headline">¶</a></h1>
<p><a class="reference internal" href="#pydeck.bindings.layer.Layer" title="pydeck.bindings.layer.Layer"><code class="xref py py-class docutils literal notranslate"><span class="pre">pydeck.bindings.layer.Layer</span></code></a> represents a kind of data visualization, like a scatterplot
or a hexbin chart.
The full <a class="reference external" href="https://github.com/uber/deck.gl/tree/master/docs/layers#deckgl-layer-catalog-overview">deck.gl layer catalog</a> is accessible via pydeck.
This page will provide more examples of how to utilize the deck.gl catalog in Python via pydeck.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>pydeck does not currently raise an error on
incorrect or omitted layer arguments</strong>. If nothing renders in
your viewport, check your browser’s
<a class="reference external" href="https://javascript.info/devtools">developer console</a> or review the layer catalog.
If you’re still stuck, file an issue with clicking <a class="reference external" href="https://github.com/uber/deck.gl/issues/new?assignees=&amp;labels=bug&amp;template=bug-report.md&amp;title=">here</a>.</p>
</div>
<dl class="py class">
<dt id="pydeck.bindings.layer.Layer">
<em class="property">class </em><code class="sig-prename descclassname">pydeck.bindings.layer.</code><code class="sig-name descname">Layer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">type</span></em>, <em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_binary_transport</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pydeck.bindings.layer.Layer" title="Permalink to this definition">¶</a></dt>
<dd><p>Configures a deck.gl layer for rendering on a map. Parameters passed
here will be specific to the particular deck.gl layer that you are choosing to use.</p>
<p>Please see the deck.gl
<a class="reference external" href="https://deck.gl/#/documentation/deckgl-api-reference/layers/overview">Layer catalog</a>
to determine the particular parameters of your layer. You are highly encouraged to look
at the examples in the pydeck documentation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>type</strong> (<em>str</em>) – Type of layer to render, e.g., <cite>HexagonLayer</cite></p></li>
<li><p><strong>id</strong> (<em>str</em><em>, </em><em>default None</em>) – Unique name for layer</p></li>
<li><p><strong>data</strong> (<em>str</em><em> or </em><em>list of dict of {str: Any}</em><em> or </em><em>pandas.DataFrame</em>) – Either a URL of data to load in or an array of data</p></li>
<li><p><strong>use_binary_transport</strong> (<em>bool</em><em>, </em><em>default None</em>) – Boolean indicating binary data</p></li>
<li><p><strong>**kwargs</strong> – Any of the parameters passable to a deck.gl layer.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>For example, here is a HexagonLayer which reads data from a URL.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pydeck</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 2014 location of car accidents in the UK</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">UK_ACCIDENTS_DATA</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/uber-common/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>                    <span class="s1">&#39;deck.gl-data/master/examples/3d-heatmap/heatmap-data.csv&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define a layer to display on a map</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">layer</span> <span class="o">=</span> <span class="n">pydeck</span><span class="o">.</span><span class="n">Layer</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;HexagonLayer&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">UK_ACCIDENTS_DATA</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">get_position</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lng&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">auto_highlight</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">elevation_scale</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pickable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">elevation_range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3000</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">extruded</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">coverage</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Alternately, input can be a pandas.DataFrame:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pydeck</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">UK_ACCIDENTS_DATA</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">layer</span> <span class="o">=</span> <span class="n">pydeck</span><span class="o">.</span><span class="n">Layer</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;HexagonLayer&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">df</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">get_position</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lng&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">auto_highlight</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">elevation_scale</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">pickable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">elevation_range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3000</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">extruded</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">coverage</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<div class="section" id="understanding-keyword-arguments-in-pydeck-layers">
<h2>Understanding keyword arguments in pydeck layers<a class="headerlink" href="#understanding-keyword-arguments-in-pydeck-layers" title="Permalink to this headline">¶</a></h2>
<p>Keyword arguments vary by layer. A catalog of available layers in
deck.gl is viewable
<a class="reference external" href="https://github.com/uber/deck.gl/tree/master/docs/layers#deckgl-layer-catalog-overview">in the deck.gl layer catalog</a>.</p>
<p>A few important observations:</p>
<ul class="simple">
<li><p>Not all layers have all parameters. For instance, <code class="docutils literal notranslate"><span class="pre">get_position</span></code> is
available for a <code class="docutils literal notranslate"><span class="pre">ScatterplotLayer</span></code> but not <code class="docutils literal notranslate"><span class="pre">ArcLayer</span></code>. Be sure to
refer to the deck.gl layer catalog to know the arguments a particular layer can be passed.</p></li>
<li><p>Styling conventions differ between deck.gl and pydeck. While you can
pass pydeck camelCased parameters, many prefer to adhere to the more common
“snake_cased” standard. The deck.gl layer catalog documentation adheres to Javascript documentation
standards; in pydeck, functions and class names follow Python
conventions:</p>
<ul>
<li><p>Layer parameters are <code class="docutils literal notranslate"><span class="pre">snake_case</span></code> in pydeck (e.g., <code class="docutils literal notranslate"><span class="pre">getPosition</span></code> in deck.gl is
<code class="docutils literal notranslate"><span class="pre">get_position</span></code> in pydeck)</p></li>
<li><p>Layer class names in deck.gl are the same in pydeck
(e.g., <code class="docutils literal notranslate"><span class="pre">HexagonLayer</span></code> remains <code class="docutils literal notranslate"><span class="pre">HexagonLayer</span></code> in both
libraries) and are passed via the <cite>type</cite> argument</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="the-type-positional-argument">
<h2>The <code class="docutils literal notranslate"><span class="pre">type</span></code> positional argument<a class="headerlink" href="#the-type-positional-argument" title="Permalink to this headline">¶</a></h2>
<p>In the <code class="docutils literal notranslate"><span class="pre">pydeck.Layer</span></code> object, <code class="docutils literal notranslate"><span class="pre">type</span></code> is a required argument and
where you pass the desired layer’s deck.gl class name–that is, you
should set it to the deck.gl layer you wish to plot. For example, notice
how passing <code class="docutils literal notranslate"><span class="pre">&quot;HexagonLayer&quot;</span></code> to``type`` below gives you a <a class="reference external" href="https://deck.gl/#/examples/core-layers/hexagon-layer">deck.gl
HexagonLayer</a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pydeck</span> <span class="k">as</span> <span class="nn">pdk</span>

<span class="n">UK_ACCIDENTS_DATA</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/uber-common/deck.gl-data/master/examples/3d-heatmap/heatmap-data.csv&#39;</span>

<span class="n">layer</span> <span class="o">=</span> <span class="n">pdk</span><span class="o">.</span><span class="n">Layer</span><span class="p">(</span>
    <span class="s1">&#39;HexagonLayer&#39;</span><span class="p">,</span>  <span class="c1"># `type` positional argument is here</span>
    <span class="n">UK_ACCIDENTS_DATA</span><span class="p">,</span>
    <span class="n">get_position</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lng&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">],</span>
    <span class="n">auto_highlight</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">elevation_scale</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">pickable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">elevation_range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3000</span><span class="p">],</span>
    <span class="n">extruded</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">coverage</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Set the viewport location</span>
<span class="n">view_state</span> <span class="o">=</span> <span class="n">pdk</span><span class="o">.</span><span class="n">ViewState</span><span class="p">(</span>
    <span class="n">longitude</span><span class="o">=-</span><span class="mf">1.415</span><span class="p">,</span>
    <span class="n">latitude</span><span class="o">=</span><span class="mf">52.2323</span><span class="p">,</span>
    <span class="n">zoom</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
    <span class="n">min_zoom</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">max_zoom</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">pitch</span><span class="o">=</span><span class="mf">40.5</span><span class="p">,</span>
    <span class="n">bearing</span><span class="o">=-</span><span class="mf">27.36</span><span class="p">)</span>

<span class="c1"># Combined all of it and render a viewport</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">pdk</span><span class="o">.</span><span class="n">Deck</span><span class="p">(</span><span class="n">layers</span><span class="o">=</span><span class="p">[</span><span class="n">layer</span><span class="p">],</span> <span class="n">initial_view_state</span><span class="o">=</span><span class="n">view_state</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="s1">&#39;hexagon-example.html&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="https://i.imgur.com/kPYIKUl.png"><img alt="Hexagon layer" src="https://i.imgur.com/kPYIKUl.png" style="width: 500px;" /></a>
<p>Try changing <code class="docutils literal notranslate"><span class="pre">type</span></code> above to <code class="docutils literal notranslate"><span class="pre">ScatterplotLayer</span></code> and add some
<code class="docutils literal notranslate"><span class="pre">ScatterplotLayer</span></code> attributes, like <code class="docutils literal notranslate"><span class="pre">get_fill_color</span></code> and <code class="docutils literal notranslate"><span class="pre">get_radius</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">layer</span> <span class="o">=</span> <span class="n">pdk</span><span class="o">.</span><span class="n">Layer</span><span class="p">(</span>
    <span class="s1">&#39;ScatterplotLayer&#39;</span><span class="p">,</span>     <span class="c1"># Change the `type` positional argument here</span>
    <span class="n">UK_ACCIDENTS_DATA</span><span class="p">,</span>
    <span class="n">get_position</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lng&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">],</span>
    <span class="n">auto_highlight</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">get_radius</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>          <span class="c1"># Radius is given in meters</span>
    <span class="n">get_fill_color</span><span class="o">=</span><span class="p">[</span><span class="mi">180</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">140</span><span class="p">],</span>  <span class="c1"># Set an RGBA value for fill</span>
    <span class="n">pickable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="https://i.imgur.com/54a7buL.png"><img alt="New layer and color" src="https://i.imgur.com/54a7buL.png" style="width: 500px;" /></a>
</div>
<div class="section" id="expression-parsers-in-pydeck-objects">
<h2>Expression parsers in pydeck objects<a class="headerlink" href="#expression-parsers-in-pydeck-objects" title="Permalink to this headline">¶</a></h2>
<p>One particularly powerful feature of pydeck is an in-built Javascript
expression parser that can process a limited subset of Javascript–no
functions are allowed, but data accessors, Boolean conditions, inline
logical statements, arithmetic operations, and arrays are available.
The full details on the deck.gl expression parser are viewable <a class="reference external" href="https://github.com/uber/deck.gl/blob/master/docs/api-reference/json/conversion-reference.md">here</a>.</p>
<p>To demonstrate the expression parser, change the color input in
<code class="docutils literal notranslate"><span class="pre">get_fill_color</span></code> to a string:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">layer</span> <span class="o">=</span> <span class="n">pdk</span><span class="o">.</span><span class="n">Layer</span><span class="p">(</span>
    <span class="s1">&#39;ScatterplotLayer&#39;</span><span class="p">,</span>
    <span class="n">UK_ACCIDENTS_DATA</span><span class="p">,</span>
    <span class="n">get_position</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lng&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">],</span>
    <span class="n">auto_highlight</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">get_radius</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">get_fill_color</span><span class="o">=</span><span class="s1">&#39;[180, 0, 200, 140]&#39;</span><span class="p">,</span>
    <span class="n">pickable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="https://i.imgur.com/54a7buL.png"><img alt="Passing a string instead of an array" src="https://i.imgur.com/54a7buL.png" style="width: 500px;" /></a>
<p>You will notice nothing has changed. The
expression parser in deck.gl processes the <code class="docutils literal notranslate"><span class="pre">get_fill_color</span></code> argument
of <code class="docutils literal notranslate"><span class="pre">'[180,</span> <span class="pre">0,</span> <span class="pre">200,</span> <span class="pre">140]'</span></code> and converts it to a list of constants.</p>
<p>Importantly, the expression parser has access to the
variables in your data, so you can pass them from Python for use in deck.gl:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">layer</span> <span class="o">=</span> <span class="n">pdk</span><span class="o">.</span><span class="n">Layer</span><span class="p">(</span>
    <span class="s1">&#39;ScatterplotLayer&#39;</span><span class="p">,</span>
    <span class="n">UK_ACCIDENTS_DATA</span><span class="p">,</span>
    <span class="n">get_position</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lng&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">],</span>
    <span class="n">auto_highlight</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">get_radius</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">get_fill_color</span><span class="o">=</span><span class="p">[</span><span class="mi">255</span><span class="p">,</span> <span class="s1">&#39;lng &gt; 0 ? 200 * lng : -200 * lng&#39;</span><span class="p">,</span> <span class="s1">&#39;lng&#39;</span><span class="p">,</span> <span class="mi">140</span><span class="p">],</span>
    <span class="n">pickable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="passing-string-constants">
<h2>Passing string constants<a class="headerlink" href="#passing-string-constants" title="Permalink to this headline">¶</a></h2>
<p>Strings most often in pydeck indicate a data set or deck.gl variable name but
occasionally indicate a constant. In order to indiciate to the library that you’re passing a string constant,
you must quote the string. For example, below
we plot the mean of billions of dollars of profit per employee by passing <code class="docutils literal notranslate"><span class="pre">'&quot;MEAN&quot;'</span></code> to <code class="docutils literal notranslate"><span class="pre">aggregation</span></code>,
giving us the average for that statistic within an area:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">DATA_SOURCE</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/ajduberstein/geo_datasets/master/fortune_500.csv&#39;</span>

<span class="n">layer</span> <span class="o">=</span> <span class="n">pydeck</span><span class="o">.</span><span class="n">Layer</span><span class="p">(</span>
    <span class="s2">&quot;HeatmapLayer&quot;</span><span class="p">,</span>
    <span class="n">DATA_SOURCE</span><span class="p">,</span>
    <span class="n">opacity</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
    <span class="n">get_position</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">],</span>
    <span class="n">aggregation</span><span class="o">=</span><span class="s1">&#39;&quot;MEAN&quot;&#39;</span><span class="p">,</span>
    <span class="n">get_weight</span><span class="o">=</span><span class="s2">&quot;profit / employees &gt; 0 ? profit / employees : 0&quot;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="https://i.imgur.com/vJIfe71.png"><img alt="Profit per employee" src="https://i.imgur.com/vJIfe71.png" style="width: 600px;" /></a>
</div>
<div class="section" id="understanding-get-position">
<h2>Understanding <code class="docutils literal notranslate"><span class="pre">get_position</span></code><a class="headerlink" href="#understanding-get-position" title="Permalink to this headline">¶</a></h2>
<p>You may have noticed that <code class="docutils literal notranslate"><span class="pre">get_position</span></code> takes <code class="docutils literal notranslate"><span class="pre">['lng',</span> <span class="pre">'lat']</span></code> in many of these
examples. This is deck.gl’s expression parser reading the data passed to
pydeck and extracting longitude and latitude as a coordinate pair.</p>
<p>Suppose you have a CSV as follows, where the location is the first field
in the CSV (here, <code class="docutils literal notranslate"><span class="pre">coordinates</span></code>)–</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">coordinates</span><span class="p">,</span><span class="n">classification</span>
<span class="s2">&quot;[0.0, 0.0]&quot;</span><span class="p">,</span><span class="n">A</span>
<span class="s2">&quot;[0.0, 0.0]&quot;</span><span class="p">,</span><span class="n">A</span>
<span class="s2">&quot;[0.0, 1.0]&quot;</span><span class="p">,</span><span class="n">B</span>
<span class="s2">&quot;[0.0, 1.0]&quot;</span><span class="p">,</span><span class="n">C</span>
</pre></div>
</div>
<p>For this data, <code class="docutils literal notranslate"><span class="pre">get_position</span></code> here should be specified as <code class="docutils literal notranslate"><span class="pre">get_position='coordinates'</span></code></p>
<p>In many data sets, the coordinates are flattened, with X and Y coordinates specified in separate columns:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lng</span><span class="p">,</span><span class="n">lat</span><span class="p">,</span><span class="n">classification</span>
<span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="n">A</span>
<span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="n">A</span>
<span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="n">B</span>
<span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="n">C</span>
</pre></div>
</div>
<p>For the above data, you would specify position as <code class="docutils literal notranslate"><span class="pre">get_position='[lng,lat]'</span></code></p>
<p>Sometimes your data is a list of X/Y pairs. In this case, for convenience,
the deck.gl expression parser lets you pass a <code class="docutils literal notranslate"><span class="pre">'-'</span></code> to <code class="docutils literal notranslate"><span class="pre">get_position</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]]</span>
</pre></div>
</div>
<p>If your data is shaped as above, <code class="docutils literal notranslate"><span class="pre">get_position='-'</span></code> should correctly parse the input.</p>
</div>
<div class="section" id="example-vancouver-property-values">
<h2>Example: Vancouver property values<a class="headerlink" href="#example-vancouver-property-values" title="Permalink to this headline">¶</a></h2>
<p>Below, an example combining the expression parser with multiple layers, based on the deck.gl
<a class="reference external" href="https://deck.gl/#/examples/core-layers/geojson-layer-polygons">Vancouver property values example</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pydeck</span>

<span class="n">DATA_URL</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/uber-common/deck.gl-data/master/examples/geojson/vancouver-blocks.json&quot;</span>
<span class="n">LAND_COVER</span> <span class="o">=</span> <span class="p">[[[</span><span class="o">-</span><span class="mf">123.0</span><span class="p">,</span> <span class="mf">49.196</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">123.0</span><span class="p">,</span> <span class="mf">49.324</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">123.306</span><span class="p">,</span> <span class="mf">49.324</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">123.306</span><span class="p">,</span> <span class="mf">49.196</span><span class="p">]]]</span>

<span class="n">INITIAL_VIEW_STATE</span> <span class="o">=</span> <span class="n">pydeck</span><span class="o">.</span><span class="n">ViewState</span><span class="p">(</span>
  <span class="n">latitude</span><span class="o">=</span><span class="mf">49.254</span><span class="p">,</span>
  <span class="n">longitude</span><span class="o">=-</span><span class="mf">123.13</span><span class="p">,</span>
  <span class="n">zoom</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
  <span class="n">max_zoom</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
  <span class="n">pitch</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
  <span class="n">bearing</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span>

<span class="n">polygon</span> <span class="o">=</span> <span class="n">pydeck</span><span class="o">.</span><span class="n">Layer</span><span class="p">(</span>
    <span class="s1">&#39;PolygonLayer&#39;</span><span class="p">,</span>
    <span class="n">LAND_COVER</span><span class="p">,</span>
    <span class="n">stroked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="c1"># processes the data as a flat longitude-latitude pair</span>
    <span class="n">get_polygon</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>
    <span class="n">get_fill_color</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">geojson</span> <span class="o">=</span> <span class="n">pydeck</span><span class="o">.</span><span class="n">Layer</span><span class="p">(</span>
    <span class="s1">&#39;GeoJsonLayer&#39;</span><span class="p">,</span>
    <span class="n">DATA_URL</span><span class="p">,</span>
    <span class="n">opacity</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
    <span class="n">stroked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">extruded</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">wireframe</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">get_elevation</span><span class="o">=</span><span class="s1">&#39;properties.valuePerSqm / 20&#39;</span><span class="p">,</span>
    <span class="n">get_fill_color</span><span class="o">=</span><span class="s1">&#39;[255, 255, properties.growth * 255]&#39;</span><span class="p">,</span>
    <span class="n">get_line_color</span><span class="o">=</span><span class="p">[</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">],</span>
    <span class="n">pickable</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">pydeck</span><span class="o">.</span><span class="n">Deck</span><span class="p">(</span>
    <span class="n">layers</span><span class="o">=</span><span class="p">[</span><span class="n">polygon</span><span class="p">,</span> <span class="n">geojson</span><span class="p">],</span>
    <span class="n">initial_view_state</span><span class="o">=</span><span class="n">INITIAL_VIEW_STATE</span><span class="p">)</span>

<span class="n">r</span><span class="o">.</span><span class="n">to_html</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="https://i.imgur.com/M3toZK8.png"><img alt="Vancouver properties example" src="https://i.imgur.com/M3toZK8.png" style="width: 500px;" /></a>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="deck.html" class="btn btn-neutral float-right" title="Deck" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="installation.html" class="btn btn-neutral float-left" title="Installing pydeck" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Uber Technologies, Inc.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>